$(function(){function r(n,t,r){i();var f=$("#policytermvaltxt").data("value");f||(f=$("#policytermvaltxt").val()),f=f.toString().parseInteger(),f>1?$(".escalationopted").show():$(".escalationopted").hide(),$("#IsEscalationOpted").removeAttr("checked"),n=n+"?buildingVal="+(parseInt($("#buildingval").val())||0)+"&contentVal="+$("#contentval").val()+"&policyTerm="+f+"&enquiryID="+t+"&orderByAscending="+r+"&IsRented="+($("#isrented").val()=="True"?!0:!1),$.ajax({url:n,cache:!1,dataType:"html",success:function(n){$("#quotesdiv").html(n),u(),$(n).hasClass("noquotesfound show")?$(".emailquotes").hide():$(".emailquotes").show()},error:function(){console.log("getQuotes error")}})}function u(){$("button.bookingbtn[data-revisepremium='1']").each(function(){var n=$(this);$.ajax({url:"/Quotes/GetPremium?plansupplierid="+n.data("plansupplierid")+"&enquiryId="+n.data("enqid")+"&buildingval="+n.data("buildingvalue")+"&contentval="+n.data("contentvalue"),dataType:"JSON",success:function(n){$.each(n,function(){n.success=="1"?($("#bookingbtn_"+n.planid).data("premium",n.rawpremium),$("#bookingbtn_"+n.planid).data("escalationpremium",n.rawpremium),$("#bookingbtn_"+n.planid+" span.premium").text(n.premium),$("#bookingbtn_"+n.planid+" span.escalationpremium").text(n.premium)):($("#bookingbtn_"+n.planid).parents("div.quote_list:first").remove(),$(".showonquotes").length<=0?($(".noquotesfound").show(),$(".emailquotes").hide()):($(".noquotesfound").hide(),$(".emailquotes").show()))})},error:function(){console.log("getpremium error")}})})}var n=!1,t=[],i;$(document).ajaxSend(function(n,i){t.push(i)}),$(document).ajaxComplete(function(n,i){t=$.grep(t,function(n){return n!=i})}),i=function(){$.each(t,function(n,t){t.abort()})},String.prototype.parseInteger=function(){return parseInt(this.replaceAll(",","").replaceAll("â‚¹",""))||0},String.prototype.replaceAll=function(n,t){var i=this;return i.replace(new RegExp(n,"g"),t)},$(".editimg, .peditimg").click(function(n){$this=$(this),$txtelem=$this.siblings("input[type=text]"),$txtelem.removeAttr("disabled"),$(n.target).attr("class").indexOf("peditimg")>-1?($this.hide(),$this.siblings(".psavespan, .pclosespan").show()):($hiddenvalelem=$this.siblings("input[type=hidden]"),$this.hide(),$this.siblings(".savespan, .closespan").show(),$txtelem.val(stringToAmount($txtelem.data("value")).toLocaleString("en-IN")))}),$(".savespan, .psavespan").click(function(n){var i,f;if($this=$(this),$txtelem=$this.siblings("input[type=text]"),i=$txtelem.val().toString(),$(n.target).attr("class").indexOf("psavespan")>-1)i=i.toString().parseInteger(),i=i>policyTermMaxMin.Max?policyTermMaxMin.Max:i,i=i<policyTermMaxMin.Min?policyTermMaxMin.Min:i,$txtelem.val(i),$("#policytermvaltxt").val(i),$txtelem.data("value",i.toString().parseInteger()),$this.hide(),$this.siblings(".pclosespan").hide(),$this.siblings(".peditimg").show(),$(".policyterm").text(i);else{var t=i.toString().parseInteger(),u=$txtelem.attr("id")=="buildingvaltxt"?!1:!0,e=checkifNumberisWholeOr50KMultiple(t);if(e)u?$("#50kmultiple_c").hide():$("#50kmultiple_b").hide();else{u?$("#50kmultiple_c").show():$("#50kmultiple_b").show();return}t=t<(u?contentValMinMaxValue.MinValue:buildingValMinMaxValue.MinValue)?0:t,t>(u?contentValMinMaxValue.MaxValue:buildingValMinMaxValue.MaxValue)&&(u?(t>contentValMinMaxValue.MaxValue||!$("#contentval").val())&&(t=contentValMinMaxValue.MaxValue):(t>buildingValMinMaxValue.MaxValue||!$("#buildingval").val())&&(t=buildingValMinMaxValue.MaxValue)),f=u?parseInt($("#buildingval").val()):parseInt($("#contentval").val()),t==0&&f==0&&(t=u?contentValMinMaxValue.MinValue:buildingValMinMaxValue.MinValue),u?$("#contentval").val(t):$("#buildingval").val(t),$hiddenvalelem=$this.siblings("input[type=hidden]"),$txtelem.val(amountToString(t)),$txtelem.data("value",t),$hiddenvalelem.val(stringToAmount(t).toString().parseInteger()),u?$("#cntntvalrd").text(amountToString(t)):$("#buildvalrd").text(amountToString(t)),$this.hide(),$this.siblings(".closespan").hide(),$this.siblings(".editimg").show()}r($(this).data("url"),$(this).data("enquiryid"),!0),$txtelem.attr("disabled","disabled")}),$(".closespan, .pclosespan").click(function(n){$this=$(this),$txtelem=$this.siblings("input[type=text]"),$(n.target).attr("class").indexOf("pclosespan")>-1?($txtelem.val($txtelem.data("value")),$this.hide(),$this.siblings(".psavespan").hide(),$this.siblings(".peditimg").show()):($txtelem.val(amountToString($txtelem.data("value"))),$this.hide(),$this.siblings(".savespan").hide(),$this.siblings(".editimg").show()),$txtelem.attr("disabled","disabled"),$("#50kmultiple_c").hide(),$("#50kmultiple_b").hide()}),$(".imgsort").click(function(){var n=$(this);$(".imgsort").removeClass("hide"),n.addClass("hide"),r($(this).data("url"),$(this).data("enquiryid"),n.attr("class").indexOf("asc")>-1?!0:!1)}),$("#IsEscalationOpted").on("change",function(){this.checked?($(".escalationpremium").show(),$(".premium").hide()):($(".premium").show(),$(".escalationpremium").hide())}).trigger("change");$("body").on("click",".bookingbtn",function(){if($(this).data("premium")&&parseInt($(this).data("premium"))>0){showLoading(),i();var t=$(this).data("enqid"),n=$(this).data("url");n=n+"?planid="+$(this).data("planid")+"&premium="+($("#IsEscalationOpted").is(":checked")?$(this).data("escalationpremium"):$(this).data("premium"))+"&enquiryId="+t+"&buildingValue="+$(this).data("buildingvalue")+"&contentValue="+$(this).data("contentvalue")+"&isEscalationOpted="+$("#IsEscalationOpted").is(":checked"),$.ajax({url:n,dataType:"JSON",success:function(){window.location.href="/Quotes/Product?enquiryID="+t,hideLoading()},error:function(){console.log(".bookingbtn click error"),hideLoading()}})}});u(),$(".emailquotes").click(function(){$.ajax({url:"/Quotes/SendQuotesMail?enquiryid="+$(this).data("enquiryid")+"&isescalation="+$("#IsEscalationOpted").is(":checked"),success:function(){alert("Quotes sent successfully!")},error:function(){console.log("emailquotes error")}})}),$("#ismobile").val()=="True"?(n=!0,$(".quote_filter").hide()):n=!1,$(".filter_close").click(function(){n&&$(".quote_filter").hide()}),$(".filter_open").click(function(){n&&$(".quote_filter").show()}),$(".filter_btn").click(function(){n&&$(".quote_filter").hide()}),$("#quotesdiv div").hasClass("noquotesfound show")?$(".emailquotes").hide():$(".emailquotes").show()})